{#
 # This file is part of the OpenMiamMiam project.
 # (c) Isics <contact@isics.fr>
 #
 # This source file is subject to the AGPL v3 license that is bundled
 # with this source code in the file LICENSE.
 #}
{% embed 'IsicsOpenMiamMiamBundle:Branch:base.html.twig' with {'branch': branch} %}
    {% block title %}{{ category.name }} - {{ parent() }}{% endblock %}

    {% block content %}
        <ol class="breadcrumb">
            <li><a href="{{ path('open_miam_miam_branch_homepage', {'branch_slug': branch.slug}) }}">{{ 'homepage'|trans }}</a></li>
            <li class="active">{{ category.name }}</li>
        </ol>

        <h1>{{ category.name }}</h1>

        {% set products = get_products_to_display(branch, category) %}
        {% if products|length > 0 %}
            {% include 'IsicsOpenMiamMiamBundle:Catalog:showProducts.html.twig' with {'branch': branch, 'products': products} %}
        {% endif %}

        {% for subCategory in category.children %}
            {% set products = get_products_to_display(branch, subCategory) %}
            {% if products|length > 0 %}
                <h2>{{ subCategory.name }}</h2>

                {% include 'IsicsOpenMiamMiamBundle:Catalog:showProducts.html.twig' with {'branch': branch, 'products': products} %}
            {% endif %}
        {% endfor %}

    {% endblock %}
{% endembed %}
